#include <stdio.h>
#include <string.h>

struct TAC {
    char data[20];
    char temp[10];
}s[30];

int main() {
    char expr[200];
    char lhs[20];
    int i = 0, j = 1, k = 0, len = 0;

    printf("Enter expression (example: out = in1 + in2 + in3 - in4)\n");
    fgets(expr, 200, stdin);

    // Tokenize the input
    char *token = strtok(expr, " ");
    while(token != NULL) {
        strcpy(s[len].data, token);
        len++;
        token = strtok(NULL, " ");
    }

    // Left-hand side variable
    strcpy(lhs, s[0].data);

    // First operator evaluation
    printf("Three Address Code:\n");

    printf("t1 = %s %s %s\n", s[2].data, s[3].data, s[4].data);
    sprintf(s[1].temp, "t1");
    j = 2;

    // Remaining operators
    for(i = 4; i < len - 2; i += 2) {
        sprintf(s[j].temp, "t%d", j);
        printf("%s = %s %s %s\n", s[j].temp, s[j - 1].temp, s[i + 1].data, s[i + 2].data);
        j++;
    }

    // Final assignment
    printf("%s = %s\n", lhs, s[j - 1].temp);

    return 0;
}
